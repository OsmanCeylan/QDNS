

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Advanged Applications &mdash; QDNS 0.55-stable documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Noise" href="Noise.html" />
    <link rel="prev" title="Communication" href="Sends.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> QDNS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Install.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Design.html">Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hello.html">Hello QDNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Backend.html">Backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quantum.html">Quantum Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hardware.html">Hardware Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sends.html">Communication</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanged Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#multi-application">Multi Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-new-applications">Creating new applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="#application-manager">Application Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Noise.html">Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="Qkd.html">QKD Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Attack.html">Eavesdropping</a></li>
<li class="toctree-l1"><a class="reference internal" href="Features.html">Result</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QDNS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Advanged Applications</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/docs/App.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="advanged-applications">
<h1>Advanged Applications<a class="headerlink" href="#advanged-applications" title="Permalink to this headline">¶</a></h1>
<section id="multi-application">
<h2>Multi Application<a class="headerlink" href="#multi-application" title="Permalink to this headline">¶</a></h2>
<p>QDNS allows multiple applications to run on one device at same time.
With this design, one application can run a protocol with a target device, while another application in same device can run a different protocol with any device it is connected to.</p>
<img alt="alternate text" class="align-left" src="../_images/mult.png" />
<p>In the following application Alice will send data from default application to Bob.
Bob will then send this data to its secondary application via localhost.
The secondary application will resend the data it receives to Alice:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">QDNS</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="k">class</span> <span class="nc">Alice</span><span class="p">(</span><span class="n">QDNS</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_new_application</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alice_default_app</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_new_application</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alice_second_app</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;second_app&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">alice_default_app</span><span class="p">(</span><span class="n">default_app</span><span class="p">:</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">Application</span><span class="p">,</span> <span class="o">*</span><span class="n">user_args</span><span class="p">):</span>
        <span class="c1"># Send Bob a data.</span>
        <span class="n">default_app</span><span class="o">.</span><span class="n">send_classic_data</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Hello </span><span class="si">{}</span><span class="s2">!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">default_app</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">alice_second_app</span><span class="p">(</span><span class="n">second_app</span><span class="p">:</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">Application</span><span class="p">,</span> <span class="o">*</span><span class="n">user_args</span><span class="p">):</span>
        <span class="c1"># Wait data from Bob.</span>
        <span class="n">package</span> <span class="o">=</span> <span class="n">second_app</span><span class="o">.</span><span class="n">wait_next_package</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">::</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">second_app</span><span class="o">.</span><span class="n">host_label</span><span class="p">,</span> <span class="n">second_app</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">package</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Bob</span><span class="p">(</span><span class="n">QDNS</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_new_application</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bob_default_app</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_new_application</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bob_second_app</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;second_app&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">bob_default_app</span><span class="p">(</span><span class="n">default_app</span><span class="p">:</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">Application</span><span class="p">,</span> <span class="o">*</span><span class="n">user_args</span><span class="p">):</span>
        <span class="c1"># Wait data from Alice.</span>
        <span class="n">package</span> <span class="o">=</span> <span class="n">default_app</span><span class="o">.</span><span class="n">wait_next_package</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">::</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">default_app</span><span class="o">.</span><span class="n">host_label</span><span class="p">,</span> <span class="n">default_app</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">package</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="n">default_app</span><span class="o">.</span><span class="n">put_localhost</span><span class="p">(</span><span class="n">package</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">bob_second_app</span><span class="p">(</span><span class="n">second_app</span><span class="p">:</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">Application</span><span class="p">,</span> <span class="o">*</span><span class="n">user_args</span><span class="p">):</span>
        <span class="c1"># Wait data from localhost.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">second_app</span><span class="o">.</span><span class="n">localhost_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">::</span><span class="si">{}</span><span class="s2"> Local: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">second_app</span><span class="o">.</span><span class="n">host_label</span><span class="p">,</span> <span class="n">second_app</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
        <span class="n">second_app</span><span class="o">.</span><span class="n">send_classic_data</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>

    <span class="n">alice</span> <span class="o">=</span> <span class="n">Alice</span><span class="p">()</span>
    <span class="n">bob</span> <span class="o">=</span> <span class="n">Bob</span><span class="p">()</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">add_channels</span><span class="p">(</span><span class="n">alice</span><span class="p">,</span> <span class="n">bob</span><span class="p">)</span>

    <span class="n">frames</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
    <span class="n">conf</span> <span class="o">=</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">BackendConfiguration</span><span class="p">(</span><span class="n">QDNS</span><span class="o">.</span><span class="n">CIRQ_BACKEND</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frames</span><span class="p">)</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">Simulator</span><span class="p">()</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">conf</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WARNING</span><span class="p">:</span><span class="n">QDNS</span><span class="p">::</span><span class="n">Kernel</span><span class="p">::</span><span class="n">Backend</span><span class="p">:</span><span class="n">CIRQ</span> <span class="n">backend</span> <span class="ow">is</span> <span class="n">prepaired</span> <span class="k">for</span> <span class="n">simulation</span><span class="o">.</span> <span class="n">Prepairation</span> <span class="n">time</span><span class="p">:</span> <span class="o">~</span><span class="mf">0.103</span> <span class="n">sec</span>
<span class="n">Bob</span><span class="p">::</span><span class="n">default_app</span><span class="p">:</span> <span class="s1">&#39;Hello default_app!&#39;</span>
<span class="n">Bob</span><span class="p">::</span><span class="n">second_app</span> <span class="n">Local</span><span class="p">:</span> <span class="s1">&#39;Hello default_app!&#39;</span>
<span class="n">Alice</span><span class="p">::</span><span class="n">second_app</span><span class="p">:</span> <span class="s1">&#39;Hello default_app!&#39;</span>
<span class="n">WARNING</span><span class="p">:</span><span class="n">QDNS</span><span class="p">::</span><span class="n">Alice</span><span class="p">:</span><span class="n">Device</span> <span class="n">simulation</span> <span class="ow">is</span> <span class="n">idled</span> <span class="n">after</span> <span class="mf">1.0019</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">WARNING</span><span class="p">:</span><span class="n">QDNS</span><span class="p">::</span><span class="n">Bob</span><span class="p">:</span><span class="n">Device</span> <span class="n">simulation</span> <span class="ow">is</span> <span class="n">idled</span> <span class="n">after</span> <span class="mf">1.0013</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">WARNING</span><span class="p">:</span><span class="n">QDNS</span><span class="p">::</span><span class="n">Kernel</span><span class="p">:</span><span class="n">Simulation</span> <span class="ow">is</span> <span class="n">ended</span> <span class="ow">in</span> <span class="mf">1.2555</span> <span class="n">seconds</span><span class="o">.</span> <span class="n">Real</span> <span class="n">raw</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.0164</span>
</pre></div>
</div>
</section>
<section id="creating-new-applications">
<h2>Creating new applications<a class="headerlink" href="#creating-new-applications" title="Permalink to this headline">¶</a></h2>
<p>There is actually no need to create a whole class for Nodes as our examples does.
The only thing Node needs to know is application method and bind it.
Below is how a node can create an application:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_new_application</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">static</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_device_if_terminated</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">bond_end_with_device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delayed_start_time</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates new application.</span>

<span class="sd">    Args:</span>
<span class="sd">        function: Function of application.</span>
<span class="sd">        label: Label of application, default is &quot;default&quot;.</span>
<span class="sd">        static: Setts application static.</span>
<span class="sd">        enabled: Setts application enabled.</span>
<span class="sd">        end_device_if_terminated: Ends device simulation if application is termiated.</span>
<span class="sd">        bond_end_with_device: Ends device simulation if application is finished.</span>
<span class="sd">        delayed_start_time: Starts application after delay.</span>

<span class="sd">    Examples:</span>
<span class="sd">    =================================================</span>
<span class="sd">    &gt;&gt;&gt; self.create_new_application(&quot;function: bob_run&quot;, *args)</span>
<span class="sd">    &gt;&gt;&gt; self.create_new_application(&quot;function: alice_run&quot;, *args, label=&quot;alice_app&quot;)</span>
<span class="sd">    &gt;&gt;&gt; self.create_new_application(&quot;function: bob_run&quot;, *args, static=True)</span>
<span class="sd">    &gt;&gt;&gt; self.create_new_application(&quot;function: bob_run&quot;, *args, enabled=False)</span>

<span class="sd">    See QDNS/device/applicaion.Application() for more details.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Same name application in device.</span>

<span class="sd">    Return:</span>
<span class="sd">        Application or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Static flag marks the application for state tracking.
With this mark, application manager can detect applications that contains never ending while loops.
So even threads of these kind of applications shows as alive, simulation kernel terminates them when simulation going to be over soon.
<code class="docutils literal notranslate"><span class="pre">QDNS</span> <span class="pre">allows</span> <span class="pre">to</span> <span class="pre">pass</span> <span class="pre">values</span> <span class="pre">to</span> <span class="pre">application</span> <span class="pre">before</span> <span class="pre">simulation</span> <span class="pre">when</span> <span class="pre">creating</span> <span class="pre">a</span> <span class="pre">new</span> <span class="pre">application.</span></code></p>
</section>
<section id="application-manager">
<h2>Application Manager<a class="headerlink" href="#application-manager" title="Permalink to this headline">¶</a></h2>
<p>When a device is created, an application manager module is created.
This module manages how applications can be created, treated, terminated.
Here is how to set new application manager settings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_setting</span> <span class="o">=</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">ApplicationManagerSettings</span><span class="p">(</span>
    <span class="n">max_application_count</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">enable_localhost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">disable_user_apps</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">alice</span> <span class="o">=</span> <span class="n">QDNS</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="n">app_manager_settings</span><span class="o">=</span><span class="n">new_setting</span><span class="p">)</span>

<span class="c1"># OR QDNS.change_default_application_manager_settings(new_setting)</span>
</pre></div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Noise.html" class="btn btn-neutral float-right" title="Noise" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Sends.html" class="btn btn-neutral float-left" title="Communication" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, COMU Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>